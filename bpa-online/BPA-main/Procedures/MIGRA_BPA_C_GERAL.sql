SET TERM ^ ;

CREATE OR ALTER PROCEDURE MIGRA_BPA_C_GERAL 
returns (
    prd_uid varchar(7),
    prd_pa varchar(10),
    prd_cbo varchar(6),
    prd_cmp varchar(6),
    prd_qt_p double precision)
as
declare variable prd_pa_v varchar(10);
declare variable tp_bpa_v smallint;
begin
    for select s_prd.prd_uid,
               s_prd.prd_pa,
               s_prd.prd_cbo,
               s_prd.prd_cmp,
               sum(s_prd.prd_qt_p)
        from s_prd
        where s_prd.prd_org = 'BPI'
          and s_prd.prd_pa in ('0101010010','0101010028','0101010036','0101010117','0101020015','0101020023','0101020031','0101020040','0101020058','0101020066','0101020074',
                                '0101020082','0101020090','0101020112','0101030010','0101030029','0101040024','0101040032','0101040040','0101040059','0101050011','0101050020',
                                '0101050046','0101050054','0102010056','0102010064','0102010072','0102010145','0102010153','0102010161','0102010170','0102010188','0102010196',
                                '0102010200','0102010218','0102010226','0102010234','0102010242','0102010250','0102010269','0102010277','0102010285','0102010293','0102010307',
                                '0102010315','0102010323','0102010331','0102010340','0102010358','0102010366','0102010374','0102010382','0102010390','0102010404','0102010412',
                                '0102010420','0102010439','0102010447','0102010455','0102010463','0102010471','0102010480','0102010498','0102010501','0102010510','0102010528',
                                '0102010536','0102010544','0102010552','0102010560','0102010579','0102010587','0102010617','0102010641','0102020019','0102020027','0102020035',
                                '0102020043','0102020060','0102020078','0102020086','0102020094','0102020108','0102020124','0102020132','0102020140','0201010020','0201010089',
                                '0201010291','0201010348','0201010364','0201010399','0201010410','0201010445','0201010453','0201010461','0201010470','0201010569','0201010585',
                                '0201010593','0201010607','0201010631','0201010640','0201010658','0201010666','0201020017','0201020025','0201020033','0201020041','0201020050',
                                '0202010015','0202010023','0202010031','0202010040','0202010058','0202010066','0202010074','0202010082','0202010090','0202010104','0202010112',
                                '0202010120','0202010139','0202010147','0202010155','0202010163','0202010171','0202010180','0202010198','0202010201','0202010210','0202010228',
                                '0202010236','0202010252','0202010260','0202010279','0202010287','0202010295','0202010309','0202010317','0202010325','0202010333','0202010341',
                                '0202010350','0202010368','0202010376','0202010384','0202010392','0202010406','0202010414','0202010422','0202010430','0202010449','0202010457',
                                '0202010465','0202010473','0202010481','0202010490','0202010503','0202010511','0202010520','0202010538','0202010546','0202010554','0202010562',
                                '0202010570','0202010589','0202010597','0202010600','0202010619','0202010627','0202010635','0202010643','0202010651','0202010660','0202010678',
                                '0202010686','0202010694','0202010708','0202010716','0202010724','0202010732','0202010740','0202010759','0202010767','0202010775','0202010783',
                                '0202010791','0202020010','0202020029','0202020037','0202020045','0202020053','0202020061','0202020070','0202020088','0202020096','0202020100',
                                '0202020118','0202020126','0202020134','0202020142','0202020150','0202020169','0202020177','0202020185','0202020193','0202020207','0202020215',
                                '0202020223','0202020231','0202020240','0202020258','0202020266','0202020274','0202020282','0202020290','0202020304','0202020312','0202020320',
                                '0202020339','0202020347','0202020355','0202020363','0202020371','0202020380','0202020398','0202020401','0202020410','0202020428','0202020436',
                                '0202020444','0202020452','0202020460','0202020487','0202020495','0202020509','0202020517','0202020525','0202020533','0202020541','0202030016',
                                '0202030032','0202030067','0202030075','0202030083','0202030091','0202030105','0202030113','0202030121','0202030130','0202030148','0202030156',
                                '0202030164','0202030180','0202030199','0202030202','0202030229','0202030245','0202030253','0202030261','0202030270','0202030288','0202030300',
                                '0202030318','0202030326','0202030334','0202030342','0202030350','0202030369','0202030377','0202030385','0202030393','0202030407','0202030415',
                                '0202030423','0202030431','0202030440','0202030458','0202030466','0202030474','0202030482','0202030504','0202030512','0202030520','0202030539',
                                '0202030547','0202030555','0202030563','0202030571','0202030580','0202030598','0202030601','0202030610','0202030628','0202030636','0202030652',
                                '0202030660','0202030679','0202030695','0202030709','0202030717','0202030725','0202030733','0202030741','0202030750','0202030768','0202030776',
                                '0202030784','0202030792','0202030814','0202030822','0202030830','0202030849','0202030857','0202030865','0202030873','0202030881','0202030890',
                                '0202030903','0202030920','0202030938','0202030946','0202030954','0202030962','0202030970','0202031004','0202031012','0202031039','0202031047',
                                '0202031055','0202031063','0202031101','0202031110','0202031144','0202031152','0202031187','0202031195','0202031217','0202040011','0202040020',
                                '0202040038','0202040046','0202040054','0202040062','0202040070','0202040089','0202040097','0202040100','0202040119','0202040127','0202040135',
                                '0202040143','0202040151','0202040160','0202040178','0202050017','0202050025','0202050033','0202050041','0202050050','0202050068','0202050076',
                                '0202050084','0202050092','0202050106','0202050114','0202050122','0202050130','0202050149','0202050157','0202050165','0202050173','0202050181',
                                '0202050190','0202050203','0202050211','0202050220','0202050238','0202050246','0202050254','0202050262','0202050270','0202050289','0202050297',
                                '0202050300','0202050319','0202050327','0202060012','0202060020','0202060039','0202060047','0202060055','0202060063','0202060071','0202060080',
                                '0202060098','0202060101','0202060110','0202060128','0202060136','0202060144','0202060152','0202060160','0202060179','0202060187','0202060195',
                                '0202060209','0202060217','0202060225','0202060233','0202060241','0202060250','0202060268','0202060276','0202060284','0202060292','0202060306',
                                '0202060314','0202060322','0202060330','0202060349','0202060357','0202060365','0202060373','0202060381','0202060390','0202060403','0202060411',
                                '0202060420','0202060438','0202060446','0202060454','0202060462','0202060470','0202070018','0202070026','0202070034','0202070042','0202070050',
                                '0202070069','0202070077','0202070085','0202070093','0202070107','0202070115','0202070123','0202070131','0202070140','0202070158','0202070166',
                                '0202070174','0202070190','0202070204','0202070212','0202070220','0202070239','0202070247','0202070255','0202070263','0202070271','0202070280',
                                '0202070298','0202070301','0202070310','0202070328','0202070336','0202070344','0202070352','0202080013','0202080021','0202080056','0202080072',
                                '0202080080','0202080099','0202080102','0202080129','0202080145','0202080153','0202080161','0202080170','0202080188','0202080196','0202080200',
                                '0202080218','0202080226','0202080242','0202090019','0202090027','0202090035','0202090043','0202090051','0202090060','0202090078','0202090086',
                                '0202090094','0202090108','0202090116','0202090124','0202090132','0202090159','0202090167','0202090175','0202090183','0202090191','0202090213',
                                '0202090221','0202090230','0202090248','0202090256','0202090264','0202090272','0202090280','0202090299','0202090302','0202090310','0202090329',
                                '0202090337','0202090345','0202090353','0202110010','0202110044','0202110052','0202110060','0202110079','0202110087','0202110095','0202110109',
                                '0202120015','0202120023','0202120031','0202120040','0202120058','0202120066','0202120074','0202120082','0202120090','0202120104','0203010043',
                                '0203020022','0203020030','0203020065','0203020081','0204010012','0204010020','0204010039','0204010047','0204010055','0204010063','0204010071',
                                '0204010080','0204010098','0204010101','0204010110','0204010128','0204010136','0204010144','0204010152','0204010160','0204010179','0204010195',
                                '0204010209','0204020026','0204020034','0204020042','0204020050','0204020069','0204020077','0204020085','0204020093','0204020107','0204020115',
                                '0204020123','0204020131','0204030021','0204030030','0204030056','0204030064','0204030072','0204030080','0204030099','0204030102','0204030110',
                                '0204030129','0204030137','0204030145','0204030153','0204030170','0204040019','0204040027','0204040035','0204040043','0204040051','0204040060',
                                '0204040078','0204040086','0204040094','0204040108','0204040116','0204040124','0204050014','0204050022','0204050030','0204050049','0204050057',
                                '0204050065','0204050073','0204050081','0204050103','0204050111','0204050120','0204050138','0204050146','0204050154','0204050162','0204050170',
                                '0204050189','0204060010','0204060036','0204060044','0204060052','0204060060','0204060079','0204060087','0204060095','0204060109','0204060117',
                                '0204060125','0204060133','0204060141','0204060150','0204060168','0204060176','0205010016','0205010032','0205010059','0205020046','0205020054',
                                '0205020062','0205020089','0205020097','0205020100','0205020119','0205020151','0205020186','0205020224','0206010010','0206010028','0206010036',
                                '0206020015','0206020023','0206030029','0206030037','0207010030','0207010048','0207010056','0207020027','0207030022','0207030030','0209010029',
                                '0209010037','0209030011','0209040025','0209040041','0211010014','0211010022','0211010030','0211010049','0211020036','0211020044','0211020052',
                                '0211020060','0211040010','0211040029','0211040037','0211040037','0211040045','0211040053','0211040061','0211050024','0211050032','0211050040',
                                '0211050059','0211050067','0211050075','0211050083','0211050113','0211050121','0211050130','0211050156','0211060020','0211060038','0211060054',
                                '0211060062','0211060070','0211060089','0211060097','0211060100','0211060127','0211060135','0211060143','0211060151','0211060160','0211060178',
                                '0211060208','0211060216','0211060224','0211060232','0211060240','0211060259','0211060275','0211070017','0211070025','0211070033','0211070041',
                                '0211070050','0211070068','0211070076','0211070084','0211070114','0211070122','0211070130','0211070157','0211070165','0211070173','0211070181',
                                '0211070190','0211070203','0211070211','0211070220','0211070238','0211070246','0211070254','0211070262','0211070289','0211070327','0211070335',
                                '0211070343','0211070351','0211070360','0211080012','0211080020','0211080039','0211080047','0211080055','0211080063','0211080071','0211080080',
                                '0211090018','0211090026','0211090034','0211090042','0211090050','0211090069','0211090077','0211100013','0212010018','0212010042','0212010050',
                                '0212010069','0212020013','0212020021','0212020030','0212020048','0212020056','0212020064','0213010020','0213010038','0213010054','0213010062',
                                '0213010070','0213010089','0213010097','0213010100','0213010119','0213010127','0213010135','0213010143','0213010160','0213010178','0213010186',
                                '0213010194','0213010216','0213010224','0213010232','0213010240','0213010259','0213010267','0213010275','0213010291','0213010305','0213010321',
                                '0213010330','0213010348','0213010356','0213010364','0213010372','0213010380','0213010399','0213010402','0213010410','0213010429','0213010437',
                                '0213010445','0213010453','0213010461','0213010470','0213010488','0213010496','0213010518','0213010526','0213010534','0213010550','0213010569',
                                '0213010577','0213010585','0213010607','0213010615','0213010623','0213010631','0213010640','0213010658','0213010674','0213010682','0213010704',
                                '0213020017','0213020025','0213020033','0213020041','0213020050','0213020068','0213020076','0213020084','0214010015','0214010023','0214010031',
                                '0214010058','0214010066','0214010074','0214010104','0301010013','0301010021','0102010625',
                                '0301010099','0301010129','0301010153','0301010161','0301010307','0301030014','0301030022','0301030049','0301030057',
                                '0301030065','0301030073','0301030081','0301030090','0301030111','0301030120','0301030138','0301030146','0301030154','0301030162','0301030170',
                                '0301030189','0301030197','0301040010','0301040036','0301040044','0301040079','0301040087','0301040095','0301050058','0301050082','0301050090',
                                '0301050104','0301050112','0301050120','0301050139','0301050147','0301060029','0301060037','0301060045','0301060053','0301060061','0301060096',
                                '0301060100','0301060118','0301070083','0301070091','0301070270','0301080011','0301080143','0301080151','0301080160','0301080178','0301080259',
                                '0301080267','0301080305','0301080313','0301080321','0301080330','0301080399','0301080402','0301080410','0301080429','0301080453','0301080461',
                                '0301100012','0301100039','0301100047','0301100055','0301100101','0301100128','0301100136','0301100144','0301100152','0301100179','0301100187',
                                '0303020016','0303020024','0303050020','0303070013','0303070030','0303070048','0303070056','0303080019','0303080027','0303080035','0303090014',
                                '0303090030','0303090073','0303090081','0303090090','0303090111','0303090120','0303090146','0303090154','0303090162','0303090189','0303090200',
                                '0303090219','0303090227','0303090251','0303090260','0303090286','0303120053','0303140011','0306010011','0306010020','0306010038','0307010015',
                                '0307010031','0307010058','0307020010','0307020029','0307020037','0307020045','0307020053','0307020061','0307020070','0307020088','0307020096',
                                '0307020100','0307020118','0307030024','0307030032','0307030040','0307030059','0307040011','0307040062','0307040070','0307040089','0307040135',
                                '0307040143','0307040151','0307040160','0309020018','0309020026','0309020034','0309030013','0309030021','0309030030','0309030048','0309030056',
                                '0309030064','0309030072','0309030080','0309030145','0309030153','0309040027','0309050014','0309050022','0309050030','0309050049','0309050057',
                                '0309050065','0311020020','0311020038','0311020046','0401010031','0401010066','0401010074','0401010082','0401010090','0401010112','0401010120',
                                '0401010139','0404010075','0404010091','0404010156','0404010245','0404010261','0404010270','0404010296','0404010300','0404010369','0404010393',
                                '0404010440','0404020445','0404020488','0404020577','0404020615','0404020623','0404020631','0404020674','0405010052','0405010060','0405010109',
                                '0405010141','0405010206','0405030037','0405030100','0405030150','0405040199','0405050062','0405050070','0405050364','0406020094','0406020132',
                                '0406020140','0406020205','0406020299','0407010319','0407010327','0407020055','0407020160','0407020314','0407020373','0407020390','0407020489',
                                '0407020497','0408060220','0408060654','0408060689','0409010154','0409010162','0409010278','0409010448','0409020060','0409020117','0409020184',
                                '0409040100','0409050059','0409050067','0409060062','0409060089','0409060097','0409060305','0409070173','0410010022','0410010030','0410010103',
                                '0411010069','0413010023','0413040011','0414010345','0414010361','0414010388','0414020022','0414020030','0414020049','0414020057','0414020065',
                                '0414020073','0414020081','0414020090','0414020120','0414020138','0414020146','0414020154','0414020162','0414020170','0414020200','0414020219',
                                '0414020243','0414020278','0414020294','0414020359','0414020367','0414020375','0414020383','0414020405','0415040043','0415040051','0417010060',
                                '0501030018','0501030026','0501030042','0501030115','0801010012','0801010020','0804020051'
                                )
        group by 1,2,3,4
        into :prd_uid, :prd_pa, :prd_cbo, :prd_cmp, :prd_qt_p
    do begin

   INSERT INTO s_prd (PRD_UID, PRD_CMP, PRD_CNSMED, PRD_CBO, PRD_FLH, PRD_SEQ, PRD_PA, PRD_CNSPAC, PRD_SEXO, PRD_IBGE, PRD_DTATEN, PRD_CID, PRD_IDADE, PRD_QT_P, PRD_CATEN, PRD_NAUT, PRD_ORG, PRD_MVM, PRD_FLPA, PRD_FLCBO, PRD_FLCA, PRD_FLIDA, PRD_FLQT, PRD_FLER, PRD_FLMUN, PRD_FLCID) VALUES (:prd_uid, :prd_cmp, '', :prd_cbo, '001', '01', :prd_pa, '', '', '', '', '', '000', :prd_qt_p, '', '', 'BPA', :prd_cmp, 0, 0, 0, 0, 0, 0,0,0);

   delete from s_prd
   where s_prd.prd_org = 'BPI'
     and s_prd.prd_pa = :prd_pa;

  suspend;
  end

end^

SET TERM ; ^